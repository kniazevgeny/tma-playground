import{g as Zt,j as $t}from"./client-Bh7on54W.js";class j extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,this.name="TypedError",Object.setPrototypeOf(this,j.prototype)}}function Zn(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const zn="ERR_INVALID_VALUE",Qn="ERR_UNEXPECTED_VALUE",er="ERR_UNEXPECTED_TYPE",zt="ERR_PARSE";function tr(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new j(zt,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function Qt(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new j(zn,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new j(Qn);return t}function Q(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new j(zt,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function nr(e,t){return Q("object",n=>{const r=Qt(n);return tr(e,o=>r[o])})}function en(e){throw new j(er,`Unexpected value received: ${JSON.stringify(e)}`)}const tt=Q("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();en(e)});function Z(e){return/^#[\da-f]{6}$/i.test(e)}function rr(e){return/^#[\da-f]{3}$/i.test(e)}function or(e){const t=e.replace(/\s/g,"").toLowerCase();if(Z(t))return t;if(rr(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const sr=Q("rgb",e=>or(tt()(e))),ir=Q("themeParams",e=>{const t=sr(!0);return Object.entries(Qt(e)).reduce((n,[r,o])=>(n[Zn(r)]=t(o),n),{})});function ar(e,t){return Q("array",n=>{let r;if(Array.isArray(n))r=n;else if(typeof n=="string")try{const o=JSON.parse(n);Array.isArray(o)&&(r=o)}catch{}return r||en(n),r.map(e)})}class N extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,this.name="TypedError",Object.setPrototypeOf(this,N.prototype)}}function tn(e){return e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}function cr(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}const ur="ERR_INVALID_VALUE",pr="ERR_UNEXPECTED_VALUE",lr="ERR_UNEXPECTED_TYPE",nn="ERR_PARSE";function rn(e,t){const n={};for(const r in e){const o=e[r];if(!o)continue;let s,i;typeof o=="function"?(s=r,i=o):[s,i]=o;try{const a=i(t(s));a!==void 0&&(n[r]=a)}catch(a){throw new N(nn,`Parser for "${r}" property failed${s===r?"":`. Source field: "${s}"`}`,a)}}return n}function on(e){let t=e;if(typeof t=="string")try{t=JSON.parse(t)}catch(n){throw new N(ur,{cause:n})}if(typeof t!="object"||!t||Array.isArray(t))throw new N(pr);return t}function $(e,t){return n=>{const r=o=>{if(!(n&&o===void 0))try{return t(o)}catch(s){throw new N(nn,{message:`"${e}" transformer failed to parse the value`,cause:s})}};return Object.assign(r,{isValid(o){try{return r(o),!0}catch{return!1}}})}}function k(e,t){return $(t||"object",n=>{const r=on(n);return rn(e,o=>r[o])})}function ee(e){throw new N(lr,`Unexpected value received: ${JSON.stringify(e)}`)}const ae=$("boolean",e=>{if(typeof e=="boolean")return e;const t=String(e);if(t==="1"||t==="true")return!0;if(t==="0"||t==="false")return!1;ee(e)}),S=$("string",e=>{if(typeof e=="string"||typeof e=="number")return e.toString();ee(e)}),z=$("number",e=>{if(typeof e=="number")return e;if(typeof e=="string"){const t=Number(e);if(!Number.isNaN(t))return t}ee(e)}),fr=$("date",e=>e instanceof Date?e:new Date(z()(e)*1e3));function sn(e,t){return $(t||"searchParams",n=>{typeof n!="string"&&!(n instanceof URLSearchParams)&&ee(n);const r=typeof n=="string"?new URLSearchParams(n):n;return rn(e,o=>{const s=r.get(o);return s===null?void 0:s})})}function Pe(e){for(const t in e)e[t]=[tn(t),e[t]];return e}const _r=e=>{const t=z(),n=z(!0),r=S(),o=S(!0),s=ae(!0),i=k(Pe({addedToAttachmentMenu:s,allowsWriteToPm:s,firstName:r,id:t,isBot:s,isPremium:s,languageCode:o,lastName:o,photoUrl:o,username:o}),"User")(!0);return sn(Pe({authDate:fr(),canSendAfter:n,chat:k(Pe({id:t,type:r,title:r,photoUrl:o,username:o}),"Chat")(!0),chatInstance:o,chatType:o,hash:r,queryId:o,receiver:i,startParam:o,signature:r,user:i}),"initData")(e)};function hr(e){return/^#[\da-f]{6}$/i.test(e)}function dr(e){return/^#[\da-f]{3}$/i.test(e)}function br(e){const t=e.replace(/\s/g,"").toLowerCase();if(hr(t))return t;if(dr(t)){let r="#";for(let o=0;o<3;o+=1)r+=t[1+o].repeat(2);return r}const n=t.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||t.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!n)throw new Error(`Value "${e}" does not satisfy any of known RGB formats.`);return n.slice(1).reduce((r,o)=>{const s=parseInt(o,10).toString(16);return r+(s.length===1?"0":"")+s},"#")}const gr=$("rgb",e=>br(S()(e))),It=$("themeParams",e=>{const t=gr(!0);return Object.entries(on(e)).reduce((n,[r,o])=>(n[cr(r)]=t(o),n),{})});function Pt(e){return JSON.stringify(Object.fromEntries(Object.entries(e).map(([t,n])=>[tn(t),n])))}const wr=e=>{const t=S(),n=S(!0),r=ae(!0);return sn({botInline:["tgWebAppBotInline",r],defaultColors:["tgWebAppDefaultColors",It(!0)],fullscreen:["tgWebAppFullscreen",r],initData:["tgWebAppData",_r(!0)],initDataRaw:["tgWebAppData",n],platform:["tgWebAppPlatform",t],showSettings:["tgWebAppShowSettings",r],startParam:["tgWebAppStartParam",n],themeParams:["tgWebAppThemeParams",It()],version:["tgWebAppVersion",t]},"launchParams")(e)};function mr(e){const{initDataRaw:t,startParam:n,showSettings:r,botInline:o,fullscreen:s,defaultColors:i}=e,a=new URLSearchParams;return a.set("tgWebAppPlatform",e.platform),a.set("tgWebAppThemeParams",Pt(e.themeParams)),a.set("tgWebAppVersion",e.version),t&&a.set("tgWebAppData",t),n&&a.set("tgWebAppStartParam",n),typeof r=="boolean"&&a.set("tgWebAppShowSettings",r?"1":"0"),typeof o=="boolean"&&a.set("tgWebAppBotInline",o?"1":"0"),typeof s=="boolean"&&a.set("tgWebAppFullscreen",s?"1":"0"),i&&a.set("tgWebAppDefaultColors",Pt(i)),a.toString()}const yr=k({eventType:S(),eventData:e=>e},"miniAppsMessage"),an=$("fn",e=>{if(typeof e=="function")return e;ee(e)}),vr=k({TelegramWebviewProxy:k({postEvent:an()})()});function cn(e){return vr().isValid(e)}function Er(){try{return window.self!==window.top}catch{return!0}}var Ar=Object.defineProperty,Sr=(e,t,n)=>t in e?Ar(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,un=(e,t,n)=>Sr(e,typeof t!="symbol"?t+"":t,n);let l=class pn extends Error{constructor(t,n,r){super(typeof n=="object"?n.message:n||t,{cause:typeof n=="object"?n.cause:r}),this.type=t,this.name="TypedError",Object.setPrototypeOf(this,pn.prototype)}};function ln(e,t,n){return e.addEventListener(t,n),()=>e.removeEventListener(t,n)}function te(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}const Rr="ERR_ABORTED",Cr="ERR_CANCELED",xr="ERR_TIMED_OUT";function Ot(e){return new l(Rr,{cause:e})}function Tt(e,t){return e.reject=t.reject,e}class b extends Promise{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s,i;super((a,p)=>{o||(o={});const{abortSignal:c}=o;if(c&&c.aborted)return p(Ot(c.reason));const[f,g]=te(),m=_=>(...L)=>(g(),_(...L)),O=new AbortController,{signal:E}=O;i=m(_=>{O.abort(_),p(_)}),s=m(a),c&&f(ln(c,"abort",()=>{i(Ot(c.reason))}));const{timeout:d}=o;if(d){const _=setTimeout(()=>{i(new l(xr,`Timeout reached: ${d}ms`))},d);f(()=>{clearTimeout(_)})}r&&r(s,i,E)}),un(this,"reject"),this.reject=i}static withFn(t,n){return new b((r,o,s)=>{try{const i=t(s);return i instanceof Promise?i.then(r,o):r(i)}catch(i){o(i)}},n)}static resolve(t){return new b(n=>{n(t)})}static reject(t){return new b((n,r)=>{r(t)})}cancel(){this.reject(new l(Cr))}catch(t){return this.then(void 0,t)}finally(t){return Tt(super.finally(t),this)}then(t,n){return Tt(super.then(t,n),this)}}function Lt(e,t){return e.resolve=t.resolve,e}let kr=class oe extends b{constructor(t,n){let r,o;typeof t=="function"?(r=t,o=n):o=t;let s;super((i,a,p)=>{s=i,r&&r(i,a,p)},o),un(this,"resolve"),this.resolve=s}static withFn(t,n){return new oe((r,o,s)=>b.withFn(t,{abortSignal:s}).then(r,o),n)}static resolve(t){return new oe(n=>{n(t)})}static reject(t){return new oe((n,r)=>{r(t)})}catch(t){return this.then(void 0,t)}finally(t){return Lt(super.finally(t),this)}then(t,n){return Lt(super.then(t,n),this)}};function fn(e){return`tapps/${e}`}function R(e,t){sessionStorage.setItem(fn(e),JSON.stringify(t))}function C(e){const t=sessionStorage.getItem(fn(e));try{return t?JSON.parse(t):void 0}catch{}}function nt(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function $r(e,t){const{textColor:n,bgColor:r,shouldLog:o=!0}=t;function s(i,...a){if(!o||typeof o=="function"&&!o())return;const p="font-weight:bold;padding:0 5px;border-radius:5px";console[i](`%c${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c / %c${e}`,`${p};background-color: lightblue;color:black`,"",`${p};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...a)}return[function(...i){s("log",...i)},function(...i){s("error",...i)}]}function rt(e,t){document.documentElement.style.setProperty(e,t)}function ot(e){document.documentElement.style.removeProperty(e)}function Ir(e,t){t()}function W(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const f=o;o=c,Ir(p,()=>{[...r].forEach(([g,m])=>{g(c,f),m&&a(g,!0)})})}};function i(c){const f=typeof c!="object"?{once:c}:c;return{once:f.once||!1,signal:f.signal||!1}}const a=(c,f)=>{const g=i(f),m=r.findIndex(([O,E])=>O===c&&E.once===g.once&&E.signal===g.signal);m>=0&&r.splice(m,1)},p=Object.assign(function(){return Pr(p),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,f){return r.push([c,i(f)]),()=>a(c,f)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return p}const Oe=[];function Pr(e){Oe.length&&Oe[Oe.length-1].add(e)}const Or=W(!1),[_n,Tr]=$r("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog:Or}),Lr={clipboard_text_received:k({req_id:S(),data:e=>e===null?e:S(!0)(e)},"clipboard_text_received"),custom_method_invoked:k({req_id:S(),result:e=>e,error:S(!0)},"custom_method_invoked"),popup_closed:$("popup_closed",e=>e?k({button_id:t=>t==null?void 0:S()(t)})()(e):{}),viewport_changed:k({height:z(),width:e=>e==null?window.innerWidth:z()(e),is_state_stable:ae(),is_expanded:ae()},"viewport_changed")};function jr(e){const t=window,[,n]=te(ln(t,"message",r=>{if(r.source!==t.parent)return;let o;try{o=yr()(r.data)}catch{return}const{eventType:s,eventData:i}=o,a=Lr[s];try{const p=a?a()(i):i;_n("Event received:",p?{eventType:s,eventData:p}:{eventType:s}),e([s,p])}catch(p){Tr([`An error occurred processing the "${s}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),o,p)}}));return n}const jt=W(),Nt=W();function Nr(){return Nt()||Nt.set(jr(jt.set)),jt}const Te=W({});function hn(e){let t=Te()[e];return t||(t=W(void 0,{equals(){return!1}}),Nr().sub(n=>{n&&n[0]===e&&t.set(n[1])}),Te.set({...Te(),[e]:t})),t}function v(e,t,n){return hn(e).sub(t,n)}const Dr="ERR_RETRIEVE_LP_FAILED",dn="ERR_UNKNOWN_ENV",qr="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",Ur=W("https://web.telegram.org");function bn(e,t){_n("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const n=window;if(cn(n)){n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}const r=JSON.stringify({eventType:e,eventData:t});if(Er())return n.parent.postMessage(r,Ur());const{external:o}=n;if(k({notify:an()})().isValid(o)){o.notify(r);return}throw new l(dn)}function st(e,t,n){n||(n={});const{capture:r}=n,[o,s]=te();return new b(i=>{(Array.isArray(t)?t:[t]).forEach(a=>{o(v(a,p=>{(!r||(Array.isArray(t)?r({event:a,payload:p}):r(p)))&&i(p)}))}),(n.postEvent||bn)(e,n.params)},n).finally(s)}function gn(e){return wr()(e)}function wn(e){return gn(e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function Vr(){return wn(window.location.href)}function Br(){const e=performance.getEntriesByType("navigation")[0];if(!e)throw new Error("Unable to get first navigation entry.");return wn(e.name)}const Wr="launchParams";function Fr(){return gn(C(Wr)||"")}function Mr(e){R("launchParams",mr(e))}function mn(e){return e instanceof Error?e.message+(e.cause?`
  ${mn(e.cause)}`:""):JSON.stringify(e)}function le(){const e=[];for(const t of[Vr,Br,Fr])try{const n=t();return Mr(n),n}catch(n){e.push(n)}throw new l(Dr,["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","📖 Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-sdk/environment","Collected errors:",...e.map(t=>`— ${mn(t)}`)].join(`
`))}function Dt(e){try{return le(),!0}catch{return!1}return b.withFn(async()=>{if(cn(window))return!0;try{return await st("web_app_request_theme","theme_changed",{timeout:100}),!0}catch{return!1}},e)}function fe(e,t,n){hn(e).unsub(t,n)}function Hr(e){return({req_id:t})=>t===e}function qt(e){return e.split(".").map(Number)}function Jr(e,t){const n=qt(e),r=qt(t),o=Math.max(n.length,r.length);for(let s=0;s<o;s+=1){const i=n[s]||0,a=r[s]||0;if(i!==a)return i>a?1:-1}return 0}function w(e,t){return Jr(e,t)<=0}function We(e,t,n){if(typeof n=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return w("6.4",n);if(t==="try_browser")return w("7.6",n)}if(e==="web_app_set_header_color"&&t==="color")return w("6.9",n);if(e==="web_app_close"&&t==="return_back")return w("7.6",n);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return w("7.10",n)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return w("6.1",t);case"web_app_open_popup":return w("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return w("6.4",t);case"web_app_switch_inline_query":return w("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return w("6.9",t);case"web_app_setup_settings_button":return w("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return w("7.2",t);case"web_app_setup_swipe_behavior":return w("7.7",t);case"web_app_share_to_story":return w("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return w("7.10",t);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":return w("8.0",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function Yr(e,t,n,r){return st("web_app_invoke_custom_method","custom_method_invoked",{...r,params:{method:e,params:t,req_id:n},capture:Hr(n)}).then(({result:o,error:s})=>{if(s)throw new l(qr,s);return o})}function Gr(){return performance.getEntriesByType("navigation")[0]}function I(){const e=Gr();return!!e&&e.type==="reload"}let U;function Kr(e,t){U&&U.set(e,t)||t()}function Fe(e){if(U)return e();U=new Map;try{e()}finally{U.forEach(t=>t()),U=void 0}}function u(e,t){t||(t={});const n=t.equals||Object.is;let r=[],o=e;const s=c=>{if(!n(o,c)){const f=o;o=c,Kr(p,()=>{[...r].forEach(([g,m])=>{g(c,f),m&&a(g,!0)})})}};function i(c){const f=typeof c!="object"?{once:c}:c;return{once:f.once||!1,signal:f.signal||!1}}const a=(c,f)=>{const g=i(f),m=r.findIndex(([O,E])=>O===c&&E.once===g.once&&E.signal===g.signal);m>=0&&r.splice(m,1)},p=Object.assign(function(){return Xr(p),o},{destroy(){r=[]},set:s,reset(){s(e)},sub(c,f){return r.push([c,i(f)]),()=>a(c,f)},unsub:a,unsubAll(){r=r.filter(c=>c[1].signal)}});return p}const G=[];function Xr(e){G.length&&G[G.length-1].add(e)}function y(e,t){let n=new Set,r;function o(){return r||(r=u(i(),t))}function s(){o().set(i())}function i(){n.forEach(c=>{c.unsub(s,{signal:!0})});const a=new Set;let p;G.push(a);try{p=e()}finally{G.pop()}return a.forEach(c=>{c.sub(s,{signal:!0})}),n=a,p}return Object.assign(function(){return o()()},{destroy(){o().destroy()},sub(...a){return o().sub(...a)},unsub(...a){o().unsub(...a)},unsubAll(...a){o().unsubAll(...a)}})}const Zr=u((()=>{let e=0;return()=>(e+=1).toString()})()),zr=u(bn),q=u("0.0");function Qr(){return Zr()()}function _e(e,t,n){return Yr(e,t,Qr(),{...n||{},postEvent:h})}const P=(e,t,n)=>(n||(n={}),n.postEvent||(n.postEvent=h),st(e,t,n)),h=(e,t)=>zr()(e,t),J="ERR_POPUP_INVALID_PARAMS",it="ERR_INVALID_URL",eo="ERR_INVALID_SLUG",at="ERR_ALREADY_REQUESTING",ct="ERR_ALREADY_OPENED",to="ERR_ALREADY_MOUNTING",no="ERR_VARS_ALREADY_BOUND",ro="ERR_NOT_AVAILABLE",oo="ERR_NOT_INITIALIZED",Ut="ERR_NOT_SUPPORTED",so="ERR_NOT_MOUNTED",io="ERR_FULLSCREEN_FAILED";function Vt(){return typeof window>"u"}function he(e,t,{isSupported:n,isMounted:r,component:o,supports:s}={}){const i=`${o?`${o}.`:""}${e}()`;n=n?Array.isArray(n)||typeof n=="object"&&"any"in n?n:[n]:void 0;function a(d){if(s){const _=s[d];return We(_[0],_[1],q())}return!0}const p=()=>{if(!n)return;const d=`it is unsupported in Mini Apps version ${q()}`;function _(A){return typeof A=="string"?We(A,q())?void 0:d:A.fn()?void 0:A.error}if(Array.isArray(n)){for(const A of n){const kt=_(A);if(kt)return kt}return}let L;for(const A of n.any)if(L=_(A),!L)return;return d},c=(...d)=>{if(s){for(const _ in s)if(s[_][2](...d)&&!a(_))return`option ${_} is not supported in Mini Apps version ${q()}`}},f=y(()=>!p()),g=y(()=>q()!=="0.0"),m=y(()=>!r||r()),O=y(()=>Dt("simple")&&!Vt()&&g()&&f()&&m());let E;if(s){E={};for(const d in s)E[d]=y(()=>a(d))}return Object.assign((...d)=>{const _=`Unable to call the ${i} ${o?"method":"function"}:`;if(Vt()||!Dt("simple"))throw new l(dn,`${_} it can't be called outside Mini Apps`);if(!g())throw new l(oo,`${_} the SDK was not initialized. Use the SDK init() function`);const L=p();if(L)throw new l(Ut,`${_} ${L}`);const A=c(...d);if(A)throw new l(Ut,`${_} ${A}`);if(!m())throw new l(so,`${_} the component is not mounted. Use the ${o}.mount() method`);return t(...d)},t,{isAvailable:O,ifAvailable(...d){return O()?t(...d):void 0}},n?{isSupported:f}:{},E?{supports:E}:{})}function de(e,t){return t||(t={}),(n,r,o,s)=>he(n,r,{...t,isSupported:o||t.isSupported,supports:s,component:e})}function D(e,t,n){return de(e,{isSupported:n,isMounted:t})}function x(e,t){return de(e,{isSupported:t})}const ut="web_app_setup_back_button",yn="back_button_pressed",be="backButton",Bt=u(!1),Me=u(!1),vn=D(be,Me,ut),pt=x(be,ut);vn("hide",()=>{lt(!1)});pt("mount",()=>{Me()||(lt(I()&&C(be)||!1),Me.set(!0))});function lt(e){e!==Bt()&&(h(ut,{is_visible:e}),R(be,e),Bt.set(e))}pt("onClick",e=>v(yn,e));pt("offClick",e=>{fe(yn,e)});vn("show",()=>{lt(!0)});function En(e,t,n,r,o){const s=o===void 0||o?b:Promise;return Object.assign((...i)=>s.resolve().then(async()=>{if(n()){const p=t();throw r.set(p),p}Fe(()=>{n.set(s.resolve(e(...i))),r.set(void 0)});let a;try{a=[!0,await n()]}catch(p){a=[!1,p]}if(Fe(()=>{n.set(void 0),r.set(a[0]?void 0:a[1])}),!a[0])throw a[1];return a[1]}),e)}function An(e,t,n,r,o,s){const i=En(t,()=>new l(to,`The ${e} component is already mounting`),o,s);return a=>b.resolve().then(async()=>{if(!r()){const p=await i(a);Fe(()=>{r.set(!0),n(p)})}})}const T=de,Sn=u({available:!1}),Le=u(!1),je=u(!1),Rn=u(!1),ao=u(),co=u();function ft(e){return e.available?{available:!0,tokenSaved:e.token_saved,deviceId:e.device_id,accessRequested:e.access_requested,type:e.type,accessGranted:e.access_granted}:{available:!1}}const Wt="web_app_biometry_get_info",uo=he("requestBiometry",e=>P(Wt,"biometry_info_received",e).then(ft),{isSupported:Wt}),_t="web_app_biometry_request_auth",po="web_app_biometry_request_access",lo="web_app_biometry_open_settings",fo="web_app_biometry_update_token",Cn="biometry_info_received",B="biometry",_o=T(B),ho=x(B,_t),ht=D(B,Rn,_t);function xn(){throw new l(ro,"Biometry is not available")}ht("authenticate",e=>b.withFn(async t=>{if(Le())throw new l(at,"Authentication is already in progress");const n=Sn();(!n||!n.available)&&xn(),Le.set(!0);try{const r=await P(_t,"biometry_auth_requested",{abortSignal:t,params:{reason:((e||{}).reason||"").trim()}}),{token:o}=r;return typeof o=="string"&&ge({...n,token:o}),r}finally{Le.set(!1)}},e));ho("openSettings",()=>{h(lo)});ht("requestAccess",e=>b.withFn(async t=>{if(je())throw new l(at,"Access request is already in progress");je.set(!0);try{const n=await P(po,Cn,{abortSignal:t,params:{reason:(e||{}).reason||""}}).then(ft);return n.available||xn(),ge(n),n.accessGranted}finally{je.set(!1)}},e));_o("mount",An(B,e=>I()&&C(B)||uo(e),e=>{v(Cn,bo),ge(e)},Rn,co,ao));const bo=e=>{ge(ft(e))};function ge(e){Sn.set(e),R(B,e)}ht("updateToken",e=>(e||(e={}),P(fo,"biometry_token_updated",{...e,params:{token:e.token||"",reason:e.reason}}).then(t=>t.status)));function we(e,t){return de(e,{isMounted:t})}const me="closingBehavior",Ft=u(!1),He=u(!1),kn=we(me,He),go=T(me);kn("disableConfirmation",()=>{dt(!1)});kn("enableConfirmation",()=>{dt(!0)});go("mount",()=>{He()||(dt(I()&&C(me)||!1),He.set(!0))});function dt(e){e!==Ft()&&(h("web_app_setup_closing_behavior",{need_confirmation:e}),R(me,e),Ft.set(e))}const wo="web_app_invoke_custom_method",ye=x("cloudStorage",wo);ye("deleteItem",(e,t)=>{const n=Array.isArray(e)?e:[e];return n.length?_e("deleteStorageValues",{keys:n},t).then():b.resolve()});function mo(e,t){const n=Array.isArray(e)?e:[e];return n.length?_e("getStorageValues",{keys:n},t).then(r=>{const o=nr(Object.fromEntries(n.map(s=>[s,tt()])))()(r);return Array.isArray(e)?o:o[e]}):b.resolve(typeof e=="string"?"":{})}ye("getItem",mo);ye("getKeys",e=>_e("getStorageKeys",{},e).then(ar(tt())()));ye("setItem",(e,t,n)=>_e("saveStorageValue",{key:e,value:t},n).then());const ve="web_app_trigger_haptic_feedback",bt=x("hapticFeedback",ve);bt("impactOccurred",e=>{h(ve,{type:"impact",impact_style:e})});bt("notificationOccurred",e=>{h(ve,{type:"notification",notification_type:e})});bt("selectionChanged",()=>{h(ve,{type:"selection_change"})});const $n="web_app_open_invoice",yo=x("invoice",$n),Ne=u(!1);async function vo(e,t,n){if(Ne())throw new l(ct,"An invoice is already opened");let r;if(t==="url"){const{hostname:o,pathname:s}=new URL(e,window.location.href);if(o!=="t.me")throw new l(it,`Link has unexpected hostname: ${o}`);const i=s.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!i)throw new l(eo,'Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,r]=i}else r=e,n=t;return Ne.set(!0),P($n,"invoice_closed",{...n,params:{slug:r},capture:o=>r===o.slug}).then(o=>o.status).finally(()=>{Ne.set(!1)})}yo("open",vo);function In(e){return Object.fromEntries(Object.entries(e).filter(t=>t[1]!==void 0))}const Je=u(!1),De=u(!1),V=u({});function ne(e){return y(()=>V()[e])}const Pn=ne("bgColor"),On=ne("buttonColor"),Eo=ne("buttonTextColor"),Ao=ne("bottomBarBgColor"),Ye=ne("secondaryBgColor"),K=u({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),So=y(()=>{const e=K();return{...e,backgroundColor:e.backgroundColor||On()||"#2481cc",textColor:e.textColor||Eo()||"#ffffff"}}),Ge=u(!1),Ro="web_app_setup_main_button",Tn="main_button_pressed",Ee="mainButton",gt=T(Ee),Co=we(Ee,Ge);gt("mount",()=>{if(!Ge()){const e=I()&&C(Ee);e&&K.set(e),Ge.set(!0)}});gt("onClick",e=>v(Tn,e));gt("offClick",e=>{fe(Tn,e)});const xo=Co("setParams",e=>{K.set({...K(),...In(e)}),R(Ee,K());const t=So();t.text&&h(Ro,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,text:t.text,text_color:t.textColor})});function wt(){throw new l(no,"CSS variables are already bound")}function ko(e){return ir()(e)}const Ae="themeParams",$o="theme_changed",Io=T(Ae),Po=we(Ae,Je);Po("bindCssVars",e=>{De()&&wt(),e||(e=r=>`--tg-theme-${nt(r)}`);function t(r){Object.entries(V()).forEach(([o,s])=>{s&&r(o,s)})}function n(){t((r,o)=>{rt(e(r),o)})}return n(),V.sub(n),De.set(!0),()=>{t(ot),V.unsub(n),De.set(!1)}});const Oo=Io("mount",()=>{Je()||(v($o,To),V.set(I()&&C(Ae)||le().themeParams),Je.set(!0))}),To=e=>{const t=ko(e.theme_params);V.set(t),R(Ae,t)};function Ln(e){return y(()=>{const t=e();return Z(t)?t:t==="bg_color"?Pn():Ye()})}const ce=u("bg_color"),Lo=Ln(ce),ue=u("bottom_bar_bg_color"),jn=y(()=>{const e=ue();return Z(e)?e:e==="bottom_bar_bg_color"?Ao()||Ye():e==="secondary_bg_color"?Ye():Pn()}),pe=u("bg_color"),jo=Ln(pe),Ke=u(!1),qe=u(!1),mt=u(!0),No=y(()=>({backgroundColor:ce(),bottomBarColor:ue(),headerColor:pe(),isActive:mt()})),Xe="web_app_set_background_color",Ze="web_app_set_bottom_bar_color",se="web_app_set_header_color",Do="visibility_changed",re="miniApp",Nn={any:[Xe,Ze,se]},Dn=T(re),qo=x(re,Nn),Se=D(re,Ke,Nn);Se("bindCssVars",e=>{qe()&&wt();const[t,n]=te();function r(o,s){function i(){rt(o,s()||null)}i(),t(s.sub(i),ot.bind(null,o))}return e||(e=o=>`--tg-${nt(o)}`),r(e("bgColor"),Lo),r(e("bottomBarColor"),jn),r(e("headerColor"),jo),t(()=>{qe.set(!1)}),qe.set(!0),n});Dn("close",e=>{h("web_app_close",{return_back:e})});const Uo=e=>{mt.set(e.is_visible),Re()};qo("mount",()=>{if(!Ke()){const e=I()&&C(re);Oo(),Vo.ifAvailable(e?e.backgroundColor:"bg_color"),Bo.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),Wo.ifAvailable(e?e.headerColor:"bg_color"),mt.set(e?e.isActive:!0),v(Do,Uo),Ke.set(!0)}});Dn("ready",()=>{h("web_app_ready")});function Re(){R(re,No())}const Vo=Se("setBackgroundColor",e=>{e!==ce()&&(h(Xe,{color:e}),ce.set(e),Re())},Xe),Bo=Se("setBottomBarColor",e=>{e!==ue()&&(h(Ze,{color:e}),ue.set(e),Re())},Ze),Wo=Se("setHeaderColor",e=>{e!==pe()&&(h(se,Z(e)?{color:e}:{color_key:e}),pe.set(e),Re())},se,{rgb:[se,"color",Z]});function Fo(e){const t=e.message.trim(),n=(e.title||"").trim(),r=e.buttons||[];if(n.length>64)throw new l(J,`Invalid title: ${n}`);if(!t||t.length>256)throw new l(J,`Invalid message: ${t}`);if(r.length>3)throw new l(J,`Invalid buttons count: ${r.length}`);return{title:n,message:t,buttons:r.length?r.map((o,s)=>{const i=o.id||"";if(i.length>64)throw new l(J,`Button with index ${s} has invalid id: ${i}`);if(!o.type||o.type==="default"||o.type==="destructive"){const a=o.text.trim();if(!a||a.length>64)throw new l(J,`Button with index ${s} has invalid text: ${a}`);return{type:o.type,text:a,id:i}}return{type:o.type,id:i}}):[{type:"close",id:""}]}}const qn="web_app_open_popup",Mo=x("popup",qn),Ue=u(!1);Mo("open",async e=>{if(Ue())throw new l(ct,"A popup is already opened");Ue.set(!0);try{const{button_id:t=null}=await P(qn,"popup_closed",{...e,params:Fo(e)});return t}finally{Ue.set(!1)}});const Ho="web_app_close_scan_qr_popup",Un="web_app_open_scan_qr_popup",Jo="scan_qr_popup_closed",Yo="qr_text_received",Vn=x("qrScanner",Un),Mt=Vn("close",()=>{Y.set(!1),h(Ho)}),Y=u(!1);function Go(e){return b.withFn(t=>{if(Y())throw new l(ct,"The QR Scanner is already opened");Y.set(!0),e||(e={});const{onCaptured:n,text:r,capture:o}=e,[,s]=te(Y.sub(()=>{i.resolve()}),v(Jo,()=>{Y.set(!1)}),v(Yo,a=>{n?n(a.data):(!o||o(a.data))&&(i.resolve(a.data),Mt())})),i=new kr({abortSignal:t}).catch(Mt).finally(s);return(e.postEvent||h)(Un,{text:r}),i},e)}Vn("open",Go);const X=u({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),Ko=y(()=>{const e=X();return{...e,backgroundColor:e.backgroundColor||jn()||"#000000",textColor:e.textColor||On()||"#2481cc"}}),ze=u(!1),yt="web_app_setup_secondary_button",Bn="secondary_button_pressed",Ce="secondaryButton",vt=x(Ce,yt),Xo=D(Ce,ze,yt);vt("mount",()=>{if(!ze()){const e=I()&&C(Ce);e&&X.set(e),ze.set(!0)}});vt("onClick",e=>v(Bn,e));vt("offClick",e=>{fe(Bn,e)});Xo("setParams",e=>{X.set({...X(),...Object.fromEntries(Object.entries(e).filter(([,n])=>n!==void 0))}),R(Ce,X());const t=Ko();t.text&&h(yt,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,position:t.position,text:t.text,text_color:t.textColor})});const Et="web_app_setup_settings_button",Wn="settings_button_pressed",xe="settingsButton",Ht=u(!1),Qe=u(!1),At=x(xe,Et),Fn=D(xe,Qe,Et);Fn("hide",()=>{St(!1)});At("mount",()=>{Qe()||(St(I()&&C(xe)||!1),Qe.set(!0))});function St(e){e!==Ht()&&(h(Et,{is_visible:e}),R(xe,e),Ht.set(e))}At("onClick",e=>v(Wn,e));At("offClick",e=>{fe(Wn,e)});Fn("show",()=>{St(!0)});const Rt="web_app_setup_swipe_behavior",ke="swipeBehavior",et=u(!1),Jt=u(!0),Zo=x(ke,Rt),Mn=D(ke,et,Rt);Mn("disableVertical",()=>{Ct(!1)});Mn("enableVertical",()=>{Ct(!0)});Zo("mount",()=>{et()||(Ct(I()&&C(ke)||!1,!0),et.set(!0))});function Ct(e,t){(e!==Jt()||t)&&(h(Rt,{allow_vertical_swipe:e}),R(ke,e),Jt.set(e))}const F="viewport",Hn="web_app_request_fullscreen",zo="fullscreen_failed",Jn="fullscreen_changed",Qo="safe_area_changed",es="content_safe_area_changed",ts="viewport_changed",Yt="web_app_request_safe_area",Gt="web_app_request_content_safe_area",Kt={left:0,top:0,bottom:0,right:0};function Ve(e){return Math.max(e,0)}const ie=u({contentSafeAreaInsets:Kt,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:Kt,stableHeight:0,width:0});function M(e){return y(()=>ie()[e])}function H(e){const{height:t,stableHeight:n,width:r}=e;ie.set({...ie(),...In({...e,height:t?Ve(t):void 0,width:r?Ve(r):void 0,stableHeight:n?Ve(n):void 0})}),R(F,ie())}function ns(){return C(F)}const rs=M("isFullscreen"),os=u(),ss=u(),xt=u(!1),is=u(void 0),as=u(),cs=D(F,xt,Hn);function Yn(e,t){return cs(e,En(n=>P(t,[Jn,zo],n).then(r=>{if("error"in r){if(r.error==="ALREADY_FULLSCREEN")return!0;throw new l(io,"Fullscreen request failed",r.error)}return r.is_fullscreen}).then(r=>{r!==rs()&&H({isFullscreen:r})}),()=>new l(at,"Fullscreen mode change is already being requested"),os,ss))}Yn("requestFullscreen",Hn);Yn("exitFullscreen","web_app_exit_fullscreen");const Gn=T(F),us=we(F,xt);function $e(e){return y(()=>Kn()[e])}const Kn=M("safeAreaInsets"),ps=$e("bottom"),ls=$e("left"),fs=$e("right"),_s=$e("top");function Ie(e){return y(()=>Xn()[e])}const Xn=M("contentSafeAreaInsets"),hs=Ie("bottom"),ds=Ie("left"),bs=Ie("right"),gs=Ie("top"),ws=he("requestContentSafeAreaInsets",e=>P(Gt,"content_safe_area_changed",e),{isSupported:Gt}),ms=he("requestSafeAreaInsets",e=>P(Yt,"safe_area_changed",e),{isSupported:Yt});function ys(e){return P("web_app_request_viewport","viewport_changed",e).then(t=>({height:t.height,width:t.width,isExpanded:t.is_expanded,isStable:t.is_state_stable}))}const vs=e=>{const{height:t}=e;H({isExpanded:e.is_expanded,height:t,width:e.width,stableHeight:e.is_state_stable?t:void 0})},Es=e=>{H({isFullscreen:e.is_fullscreen})},As=e=>{H({safeAreaInsets:e})},Ss=e=>{H({contentSafeAreaInsets:e})};Gn("mount",An(F,e=>b.resolve().then(async()=>{const t=I()&&ns();if(t)return t;const[n,r]=await b.all([ms.ifAvailable(e)||Kn(),ws.ifAvailable(e)||Xn()]),o=le(),s={contentSafeAreaInsets:r,isFullscreen:!!o.fullscreen,safeAreaInsets:n};if(["macos","tdesktop","unigram","webk","weba","web"].includes(o.platform)){const i=window;return{...s,height:i.innerHeight,isExpanded:!0,stableHeight:i.innerHeight,width:i.innerWidth}}return ys(e).then(i=>({...s,height:i.height,isExpanded:i.isExpanded,stableHeight:i.isStable?i.height:0,width:i.width}))}),e=>{v(ts,vs),v(Jn,Es),v(Qo,As),v(es,Ss),H(e)},xt,as,is));const Be=u(!1),Rs=M("height"),Cs=M("stableHeight"),xs=M("width");us("bindCssVars",e=>{Be()&&wt(),e||(e=n=>`--tg-viewport-${nt(n)}`);const t=[["height",Rs],["stableHeight",Cs],["width",xs],["safeAreaInsetTop",_s],["safeAreaInsetBottom",ps],["safeAreaInsetLeft",ls],["safeAreaInsetRight",fs],["contentSafeAreaInsetTop",gs],["contentSafeAreaInsetBottom",hs],["contentSafeAreaInsetLeft",ds],["contentSafeAreaInsetRight",bs]].reduce((n,[r,o])=>{const s=e(r);if(s){const i=()=>{rt(s,`${o()}px`)};n.push([i,o.sub(i),s])}return n},[]);return t.forEach(n=>{n[0]()}),Be.set(!0),()=>{t.forEach(n=>{n[1](),ot(n[2])}),Be.set(!1)}});Gn("expand",()=>{h("web_app_expand")});const ks=T();ks("openLink",(e,t)=>{if(typeof e=="string")try{e=new URL(e)}catch(n){throw new l(it,`"${e.toString()}" is invalid URL`,n)}t||(t={}),h("web_app_open_link",{url:e.toString(),try_browser:t.tryBrowser,try_instant_view:t.tryInstantView})});const Xt="web_app_open_tg_link",$s=T(),Is=$s("openTelegramLink",e=>{const t=e.toString();if(!t.match(/^https:\/\/t.me\/.+/))throw new l(it,`"${t}" is invalid URL`);if(!We(Xt,q())){window.location.href=t;return}e=new URL(e),h(Xt,{path_full:e.pathname+e.search})}),Ps=T();Ps("shareURL",(e,t)=>{Is("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))});function Os(){return Zt.useMemo(le,[])}const Ls=function(){let t=null;try{t=Os()}catch{console.log("The app runs outside of the telegram")}Zt.useEffect(()=>{t&&console.log(t)},[t]);function n(){if(!t){alert("The app runs outside of the telegram");return}xo({isEnabled:!0,text:"тест",isVisible:!0,textColor:"#f00000",backgroundColor:"#111",hasShineEffect:!0})}return $t.jsxs("div",{className:"dark pt-4 min-h-screen bg-bg text-fg font-serif flex flex-col justify-center items-center",children:["Hello there",$t.jsx("div",{onClick:n,className:"hover:cursor-pointer",children:"set main button"})]})};export{Ls as component};
